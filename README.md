DeepSeek TTS

为 [DeepSeek 网页版聊天](https://chat.deepseek.com/) 提供高质量、纯前端的文本朗读功能。无需后端服务器，直接在浏览器内调用 Edge TTS 服务，为每一个用户提问和 AI 回答添加可定制的语音播放。

 ✨ 功能特点
- 纯前端实现：所有语音合成在浏览器内完成，无需搭建或依赖任何服务器。
    
- 精准句子高亮：播放时实时高亮当前句子，并自动滚动到可视区域。
    
- 智能句子分割：使用 `Intl.Segmenter` 或正则表达式准确分割中文句子。
    
- 流式合成与播放：边合成边播放，减少等待时间。
    
- 多语音选择：内置六种自然中文语音（晓晓、晓伊、云剑、云希、云霞、云扬）。
    
- 可调参数：支持语速、音量、音调的实时调节。
    
- 自动朗读：可开启自动朗读，新消息出现后自动播放。
    
- 主题适配：自动跟随 DeepSeek 页面的深色/浅色主题切换。
    
- 轻量无依赖：除 WebSocket 外不依赖任何外部服务。

 📦 安装方法

开发者模式手动加载
1. 下载本仓库源码并解压到本地文件夹。
    
2. 打开 Chrome/Edge 浏览器，进入扩展管理页面：`chrome://extensions/`或`edge://extensions/`。
    
3. 开启右上角或左侧的 “开发者模式”。
    
4. 点击 “加载已解压的扩展程序”，解压到本地的包含 `manifest.json` 的文件夹。
    
5. 确保插件已启用，图标出现在工具栏。

> 注意：如果提示“icons”文件夹缺失，可以自行创建空文件夹或忽略（图标非必需，但不影响功能）。

 🚀 使用方法
1. 访问 [DeepSeek Chat](https://chat.deepseek.com/) 并登录。
    
2. 打开任意对话，页面加载后你会看到每条用户消息和 AI 回答下方都会自动出现一个朗读控制面板。
    
3. 朗读面板 包含：
    - 语音选择下拉框（可切换不同音色）
        
    - 播放/停止按钮（按钮显示“朗读”或“停止”）
        
    - 状态徽章（“用户提问”或“AI回答”）
        
    
4. 播放操作：
    - 点击 “朗读” 按钮开始朗读该条消息的全部文本。
        
    - 朗读过程中按钮变为红色 “停止”，点击即可中断播放。
        
    - 播放时，当前句子会高亮显示，并自动滚动到视野中央。
        
    
5. 全局设置（点击浏览器工具栏中的插件图标打开弹出窗口）：
    - 语音选择：选择默认使用的音色。
        
    - 语速、音量、音调：通过滑块实时调节，数值变化会立即生效。
        
    - 自动朗读：开启后，新出现的 AI 回答将自动开始朗读（需刷新页面或新消息到来时生效）。
        
    - 测试语音：点击可试听当前设置下的合成效果。
        
    - 朗读回答：快速朗读当前页面中可见的最后一条 AI 回答（方便快速触发）。

 ⚙️ 设置选项说明
| 选⁠项 | 说⁠明 |
| --- | --- |
| 语⁠音 | 选⁠择⁠发⁠音⁠人，目⁠前⁠支⁠持 6 种⁠中⁠文⁠语⁠音。 |
| 语⁠速 | 范⁠围 -50% ~ +50%，负⁠值⁠减⁠慢，正⁠值⁠加⁠快。 |
| 音⁠量 | 范⁠围 -50% ~ +50%，0% 为⁠默⁠认⁠音⁠量。 |
| 音⁠调 | 范⁠围 -50Hz ~ +50Hz，调⁠节⁠声⁠音⁠高⁠低。 |
| 自⁠动⁠朗⁠读 | 开⁠启⁠后，新⁠收⁠到⁠的 AI 回⁠答⁠自⁠动⁠开⁠始⁠朗⁠读。 |

 🔧 技术实现
- 语音合成：基于 `edge-tts-browser.js`（一个浏览器端实现的 Edge TTS 客户端），通过 WebSocket 连接微软语音服务，获取 MP3 音频流。
    
- 句子分割：优先使用 `Intl.Segmenter`，降级使用正则分割，确保中文句子边界准确。
    
- 高亮与滚动：利用 DOM 文本节点索引，精确计算每个句子在原始 HTML 中的偏移量，播放时高亮对应文本节点，并调用 `scrollIntoView` 滚动。
    
- 并发控制：最多同时进行 2 个句子的合成，避免 WebSocket 连接过多。
    
- 主题同步：监听 `html` 和 `body` 的类名或 `data-theme` 属性变化，动态调整插件面板颜色。

 ⚠️ 注意事项
- 插件仅能在 `https://chat.deepseek.com/*` 域名下工作，其他页面不会显示朗读面板。
    
- 所有语音合成需联网（连接微软 Edge TTS 服务），无网络时无法使用。
    
- 如果遇到播放卡顿或高亮不准确，可尝试刷新页面。
    
- 由于浏览器安全策略，自动播放可能被阻止，首次播放可能需要用户手动点击一次页面任意位置（之后自动朗读可正常工作）。
    
- 若长时间未收到音频，可能是网络问题或服务端限制，建议稍后再试。

 🤝 贡献与反馈

欢迎提交 Issue 或 Pull Request。如果你有新的功能建议或发现了 bug，请在 GitHub 仓库中反馈。

---

让 DeepSeek 的回答不仅能看，还能听！
